(()=>{function e(e,t){return 1===e.length?"month"===t?`0${parseInt(e)+1}`:`0${e}`:"month"===t?parseInt(e)+1:e}function t(t){return`${e(t.getDate().toString(),"day")}/${e(t.getMonth().toString(),"month")}/${t.getFullYear()}`}function n(e,t){let n,s,a,u=[];return[e,t].forEach((e=>{if(void 0===e)return u;n=1===e.getHours().toString().length?`0${e.getHours()}`:e.getHours(),s=1===e.getMinutes().toString().length?`0${e.getMinutes()}`:e.getMinutes(),a=`${n}:${s}`,u=u.concat(a)})),u}function s(e,t){let n=new Date(e);return n.setDate(e.getDate()+t),n}function a(e,t,s,a){let u=s.sort(((e,t)=>e.start>t.start?1:-1)),o=[[e,e]],l=[];return u.forEach((n=>{Date.parse(`01/01/2011 ${e}`)<=Date.parse(`01/01/2011 ${n.start}`)<Date.parse(`01/01/2011  ${t}`)&&o.push([n.start,n.end])})),o.push([t,t]),o.forEach(((e,t)=>{if(t>0&&new Date(`01/01/2011 ${o[t][0]}`)-new Date(`01/01/2011 ${o[t-1][1]}`)>0){let e=new Date(`01/01/2011 ${o[t-1][1]}`),s=structuredClone(e),u=Math.abs(new Date(`01/01/2011 ${o[t][0]}`)-new Date(`01/01/2011 ${o[t-1][1]}`))/36e5*60,i=new Date(s.setMinutes(s.getMinutes()+u));u>=a&&l.push(n(e,i))}})),l}function u(t,n){let s=e(t.getDate().toString(),"day"),a=e(t.getMonth().toString(),"month");return"br"===n?`${s}/${a}/${t.getFullYear()}`:`${a}/${s}/${t.getFullYear()}`}!function(){let e=components.schedule__schedule.value.slice(0,-1).split("T"),o=function(e){let t=e.split("/");return`${t[1]}/${t[0]}/${t[2]}`}(e[0]),l=e[1].substring(0,5);components.schedule__schedule_2.value=o+" "+l,async function(){let e=components.service__service_id.value,o=await async function(e){let o=components.schedule__physiotherapist_id.value,l=await async function(e){let t=await executeAction("getphysiosaasagenda",null,{physiotherapistId:e}),n={domingo:0,"segunda-feira":1,"terça-feira":2,"quarta-feira":3,"quinta-feira":4,"sexta-feira":5,sábado:6};return t.forEach((e=>{e.weekday in n&&(e.weekday=n[e.weekday])})),t}(o),i=(await executeAction("getserviceduration",null,{serviceId:e}))[0].service__duration,r=await async function(e,n){let s=new Date;s.setDate(s.getDate()+20);let a=s.toJSON().slice(0,10).replace(/-/g,"-"),u={};return(await executeAction("getsaasphysioschedules",null,{physiotherapistId:n,endDate:a})).forEach((e=>{let s={},a="",o=e.duration,l=e.schedule.slice(0,-1).split("T"),i=new Date(l);i.setMinutes(i.getMinutes()+o);let r=1===i.getHours().toString().length?`0${i.getHours()}`:i.getHours(),c=1===i.getMinutes().toString().length?`0${i.getMinutes()}`:i.getMinutes();s={start:l[1].substring(0,5),end:`${r}:${c}`},a=t(i),Object.keys(u).includes(n)?(Object.keys(u[n]).includes(a)||(u[n][a]=[]),u[n][a].push(s)):u[n]={[a]:[s]}})),u}(0,o),c=await function(e,n,u,o){let l=new Date,i=[],r=[];for(let e=0;e<20;e++)i.push(s(l,e));for(dateIndex in i){let e=i[dateIndex],s=e.getDay(),l=t(e),c=n.filter((e=>e.weekday==s));for(agendaIndex in c){let e=[];c[agendaIndex].physiotherapist_id in u&&l in u[c[agendaIndex].physiotherapist_id]&&(e=u[c[agendaIndex].physiotherapist_id][l]);let t=a(c[agendaIndex].start_hour,c[agendaIndex].end_hour,e,o);if(t){let e={date:l,free_slots:t};r.push(e)}}}return r}(0,l,r,i);return function(e){let t=new Date;t.setMinutes(t.getMinutes()+120);let n=u(t,"br"),s=u(t,"es"),a=[];return Object.keys(e).includes(n)&&(e[n].forEach((e=>{new Date(`${s} ${e}`)>t&&a.push(e)})),a.length>0?e[n]=a:delete e[n]),e}(await function(e,t){let s={};for(availableDateIndex in e){let t=[];for(freeSlotsIndex in e[availableDateIndex].free_slots){let a=new Date(`01/01/2011 ${e[availableDateIndex].free_slots[freeSlotsIndex][0]}`),u=new Date(`01/01/2011 ${e[availableDateIndex].free_slots[freeSlotsIndex][1]}`),o=a;for(;o<u;){let e,s=["00","15","30","45"],a=1===o.getMinutes().toString().length?`0${o.getMinutes()}`:`${o.getMinutes()}`;if(s.includes(a)){let e=structuredClone(o);if(e.setMinutes(e.getMinutes()+30),!(e<=u))break;t.includes(o)||(t=t.concat(n(o))),o=new Date(o.setMinutes(o.getMinutes()+15))}else{s.push(a),s.sort();let t=s.indexOf(a);e=a>"44"?60-parseInt(s[t]):parseInt(s[t+1])-parseInt(s[t]),o=new Date(o.setMinutes(o.getMinutes()+e))}}t.sort(),s[e[availableDateIndex].date]=t}}return s}(c))}(e),l=(r=o,Object.keys(r)),i=[];var r;l.forEach((e=>{i.push({label:e,value:e})})),components.schedule__schedule_date.options=i,components.schedule__schedule_date.onChange((()=>{let e=components.schedule__schedule_date.value;if(e){let t=function(e,t){return e[t]}(o,e),n=[];t.forEach((e=>{n=n.concat({label:e,value:e})})),components.schedule__schedule_hour.options=n,components.schedule__schedule_hour.value=""}else components.schedule__schedule_hour.value="",components.schedule__schedule_hour.options=[]})),components.schedule__schedule_hour.onChange((()=>{let e=components.schedule__schedule_date.value,t=components.schedule__schedule_hour.value;t&&(components.schedule__schedule.value=e+" "+t)}))}()}()})();/*! Fri Jul 15 2022 21:43:09 GMT+0000 (Coordinated Universal Time) !*/